{# templates/export/property_export.html #}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Property Report: {{ property.address }}</title>
    <style>
      @page {
        size: A4;
        margin: 15mm;
        @top-center {
          content: "SellerPrep Property Report";
          font-family: "Segoe UI", Arial, sans-serif;
          font-size: 10pt;
          color: #666;
        }
        @bottom-center {
          content: "Page " counter(page) " of " counter(pages);
          font-family: "Segoe UI", Arial, sans-serif;
          font-size: 10pt;
          color: #666;
        }
      }

      :root {
        --sp-primary: #31a354;
        --sp-secondary: #268442;
        --sp-bg: #f7fafb;
        --sp-border: #e1e6ea;
        --sp-radius: 8px;
        --sp-font: "Segoe UI", "Inter", Arial, sans-serif;
        --text-dark: #1a1a1a;
        --text-medium: #4a4a4a;
        --text-light: #666;
        --text-muted: #888;
      }

      body {
        font-family: var(--sp-font);
        color: var(--text-dark);
        margin: 0;
        padding: 0;
        line-height: 1.6;
        font-size: 11pt;
      }

      /* Header/Letterhead */
      .header {
        background: linear-gradient(135deg, var(--sp-primary) 0%, var(--sp-secondary) 100%);
        color: white;
        padding: 30px;
        margin: -15mm -15mm 20mm -15mm;
        text-align: center;
        position: relative;
      }

      .header::after {
        content: "";
        position: absolute;
        bottom: -10px;
        left: 0;
        right: 0;
        height: 10px;
        background: linear-gradient(to right, transparent, var(--sp-primary), transparent);
        opacity: 0.3;
      }

      .logo {
        font-size: 32pt;
        font-weight: 700;
        margin-bottom: 8px;
        letter-spacing: -1px;
      }

      .tagline {
        font-size: 12pt;
        opacity: 0.9;
        font-weight: 300;
      }

      /* Property Title Section */
      .property-title {
        background: white;
        border: 2px solid var(--sp-primary);
        border-radius: 12px;
        padding: 25px;
        margin: 20px 0 30px 0;
        text-align: center;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }

      .property-address {
        font-size: 24pt;
        font-weight: 700;
        color: var(--sp-primary);
        margin: 0 0 10px 0;
        line-height: 1.2;
      }

      .property-description {
        font-size: 12pt;
        color: var(--text-medium);
        font-style: italic;
        margin: 0;
      }

      /* Report Info */
      .report-info {
        background: var(--sp-bg);
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
        display: flex;
        justify-content: space-between;
        border-left: 4px solid var(--sp-primary);
      }

      .report-info div {
        text-align: center;
      }

      .report-info .label {
        font-size: 9pt;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 4px;
      }

      .report-info .value {
        font-size: 11pt;
        font-weight: 600;
        color: var(--text-dark);
      }

      /* Executive Summary */
      .executive-summary {
        background: white;
        border: 1px solid var(--sp-border);
        border-radius: 8px;
        padding: 25px;
        margin: 30px 0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      }

      .executive-summary h2 {
        color: var(--sp-primary);
        font-size: 16pt;
        margin: 0 0 15px 0;
        padding-bottom: 8px;
        border-bottom: 2px solid var(--sp-primary);
      }

      /* Section Styling */
      .section {
        page-break-inside: avoid;
        margin: 30px 0;
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        border: 1px solid var(--sp-border);
      }

      .section-header {
        background: linear-gradient(135deg, var(--sp-primary) 0%, var(--sp-secondary) 100%);
        color: white;
        padding: 20px 25px;
        font-size: 18pt;
        font-weight: 600;
        margin: 0;
        position: relative;
      }

      .section-header::after {
        content: "";
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        width: 4px;
        background: rgba(255,255,255,0.3);
      }

      .section-content {
        padding: 25px;
      }

      /* Content Cards */
      .content-group {
        margin-bottom: 25px;
      }

      .content-group:last-child {
        margin-bottom: 0;
      }

      .content-group h3 {
        color: var(--text-dark);
        font-size: 14pt;
        font-weight: 600;
        margin: 0 0 15px 0;
        padding: 12px 15px;
        border-bottom: 2px solid var(--sp-bg);
        position: relative;
        background: var(--sp-bg);
        border-radius: 6px 6px 0 0;
        border-left: 4px solid var(--sp-primary);
      }


      /* Document Styling */
      .document-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 12px;
        margin: 0;
        padding: 0;
        list-style: none;
      }

      .document-item {
        background: var(--sp-bg);
        border: 1px solid var(--sp-border);
        border-radius: 6px;
        padding: 12px 15px;
        transition: all 0.2s ease;
      }

      .document-item:hover {
        border-color: var(--sp-primary);
        box-shadow: 0 2px 8px rgba(49, 163, 84, 0.1);
      }

      .document-name {
        font-weight: 600;
        color: var(--text-dark);
        margin-bottom: 6px;
        word-break: break-word;
        font-size: 11pt;
      }

      .document-meta {
        font-size: 9pt;
        color: var(--text-muted);
        line-height: 1.4;
      }

      .document-type {
        display: inline-block;
        background: var(--sp-primary);
        color: white;
        padding: 2px 6px;
        border-radius: 3px;
        font-size: 8pt;
        text-transform: uppercase;
        margin-bottom: 4px;
        font-weight: 500;
      }

      .document-content {
        margin-top: 12px;
        padding-top: 12px;
        border-top: 1px solid var(--sp-border);
      }

      .content-header {
        font-size: 9pt;
        font-weight: 600;
        color: var(--text-medium);
        margin-bottom: 6px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .content-text {
        font-size: 9pt;
        color: var(--text-dark);
        line-height: 1.4;
        background: var(--sp-bg);
        padding: 10px;
        border-radius: 4px;
        border: 1px solid var(--sp-border);
        max-height: 200px;
        overflow: hidden;
        position: relative;
      }

      .content-text::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 20px;
        background: linear-gradient(transparent, var(--sp-bg));
        pointer-events: none;
      }

      /* Image Gallery */
      .image-gallery {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 15px 0;
      }

      .image-item {
        background: white;
        border: 1px solid var(--sp-border);
        border-radius: 8px;
        padding: 12px;
        text-align: center;
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        page-break-inside: avoid;
      }

      .image-item img {
        width: 100%;
        max-width: 100%;
        height: 160px;
        object-fit: contain;
        border-radius: 4px;
        margin-bottom: 8px;
        background: var(--sp-bg);
        border: 1px solid var(--sp-border);
      }

      .image-caption {
        font-size: 9pt;
        color: var(--text-muted);
        word-break: break-word;
      }

      /* Notes Styling */
      .notes-list {
        margin: 0;
        padding: 0;
        list-style: none;
      }

      .note-item {
        background: white;
        border: 1px solid var(--sp-border);
        border-left: 4px solid var(--sp-primary);
        border-radius: 6px;
        padding: 15px;
        margin-bottom: 12px;
        position: relative;
      }

      .note-content {
        color: var(--text-dark);
        margin-bottom: 8px;
        line-height: 1.5;
      }

      .note-date {
        font-size: 9pt;
        color: var(--text-muted);
        font-style: italic;
      }

      /* Empty State */
      .empty-state {
        text-align: center;
        padding: 30px;
        color: var(--text-light);
        font-style: italic;
        background: var(--sp-bg);
        border-radius: 6px;
        border: 1px dashed var(--sp-border);
      }

      /* Footer */
      .footer {
        margin-top: 40px;
        padding: 20px 0;
        border-top: 1px solid var(--sp-border);
        text-align: center;
        color: var(--text-muted);
        font-size: 9pt;
      }

      .footer .logo-small {
        color: var(--sp-primary);
        font-weight: 600;
        margin-bottom: 5px;
      }

      /* Print Optimizations */
      @media print {
        .section {
          page-break-inside: avoid;
          margin-bottom: 15mm;
        }

        .image-gallery {
          page-break-inside: avoid;
        }

        .image-item {
          page-break-inside: avoid;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header/Letterhead -->
    <div class="header">
      <div class="logo">SellerPrep</div>
      <div class="tagline">Professional Property Documentation & Reports</div>
    </div>

    <!-- Property Title Section -->
    <div class="property-title">
      <h1 class="property-address">{{ property.address }}</h1>
      {% if property.description %}
      <p class="property-description">{{ property.description }}</p>
      {% endif %}
    </div>

    <!-- Report Information -->
    <div class="report-info">
      <div>
        <div class="label">Generated On</div>
        <div class="value">{{ "now"|date:"F j, Y" }}</div>
      </div>
      <div>
        <div class="label">Documents</div>
        <div class="value">{{ total_documents }}</div>
      </div>
      <div>
        <div class="label">Images</div>
        <div class="value">{{ total_images }}</div>
      </div>
      <div>
        <div class="label">Notes</div>
        <div class="value">{{ total_notes }}</div>
      </div>
      <div>
        <div class="label">Sections</div>
        <div class="value">{{ total_sections }}</div>
      </div>
    </div>

    <!-- Executive Summary -->
    <div class="executive-summary">
      <h2>Executive Summary</h2>
      <p>This comprehensive property report contains detailed documentation for <strong>{{ property.address }}</strong>, generated on {{ "now"|date:"F j, Y" }}. The documentation includes:</p>

      <ul style="margin: 15px 0; padding-left: 20px;">
        <li><strong>{{ total_sections }}</strong> property section{{ total_sections|pluralize }} covering different areas of the home</li>
        <li><strong>{{ total_documents }}</strong> supporting document{{ total_documents|pluralize }} providing detailed information</li>
        <li><strong>{{ total_images }}</strong> photograph{{ total_images|pluralize }} documenting current conditions</li>
        <li><strong>{{ total_notes }}</strong> detailed note{{ total_notes|pluralize }} with important observations</li>
      </ul>

      {% if sections_data %}
      <p>Each section has been systematically documented to provide transparency and valuable information for potential buyers, real estate agents, and property stakeholders. This report serves as a comprehensive reference for the property's current state, maintenance history, and important details that support informed decision-making.</p>
      {% else %}
      <p>This property is ready for documentation. Sections can be added to organize information about different areas of the home, including supporting documents, images, and notes.</p>
      {% endif %}

      <p><em>Prepared by SellerPrep Professional Property Documentation System</em></p>
    </div>

    <!-- Sections Content -->
    {% for sec in sections_data %}
    <div class="section">
      <h2 class="section-header">{{ sec.title }}</h2>
      <div class="section-content">

        <!-- Documents -->
        <div class="content-group">
          <h3>Documents</h3>
          {% if sec.documents %}
          <ul class="document-list">
            {% for doc in sec.documents %}
            <li class="document-item">
              {% if doc.preview.type == ".pdf" %}
                <div class="document-type">PDF</div>
              {% elif doc.preview.type == ".jpg" or doc.preview.type == ".jpeg" %}
                <div class="document-type">IMAGE</div>
              {% elif doc.preview.type == ".png" %}
                <div class="document-type">IMAGE</div>
              {% elif doc.preview.type == ".doc" or doc.preview.type == ".docx" %}
                <div class="document-type">WORD</div>
              {% elif doc.preview.type == ".xls" or doc.preview.type == ".xlsx" %}
                <div class="document-type">EXCEL</div>
              {% elif doc.preview.type == ".txt" %}
                <div class="document-type">TEXT</div>
              {% else %}
                <div class="document-type">FILE</div>
              {% endif %}
              <div class="document-name">{{ doc.filename }}</div>
              <div class="document-meta">
                Uploaded: {{ doc.uploaded }}
                {% if doc.preview.file_info.size %}
                  <br><small>Size: {{ doc.preview.file_info.size }}</small>
                {% endif %}
                {% if doc.preview.file_info.mime_type and doc.preview.file_info.mime_type != "unknown" %}
                  <br><small>Type: {{ doc.preview.file_info.mime_type }}</small>
                {% endif %}
              </div>
              {% if doc.preview.description %}
              <div class="document-content">
                <div class="content-header">Document Information:</div>
                <div class="content-text">{{ doc.preview.description }}</div>
              </div>
              {% endif %}
              {% if doc.preview.preview_text and doc.preview.extractable %}
              <div class="document-content">
                <div class="content-header">Content Preview:</div>
                <div class="content-text">{{ doc.preview.preview_text|linebreaks }}</div>
              </div>
              {% endif %}
            </li>
            {% endfor %}
          </ul>
          {% else %}
          <div class="empty-state">No documents available for this section</div>
          {% endif %}
        </div>

        <!-- Images -->
        <div class="content-group">
          <h3>Images</h3>
          {% if sec.images %}
          <div class="image-gallery">
            {% for img in sec.images %}
            <div class="image-item">
              <img src="{{ img.url }}" alt="{{ img.filename }}" />
              <div class="image-caption">
                {{ img.filename }}<br>
                <small>{{ img.uploaded }}</small>
              </div>
            </div>
            {% endfor %}
          </div>
          {% else %}
          <div class="empty-state">No images available for this section</div>
          {% endif %}
        </div>

        <!-- Notes -->
        <div class="content-group">
          <h3>Notes</h3>
          {% if sec.notes %}
          <ul class="notes-list">
            {% for note in sec.notes %}
            <li class="note-item">
              <div class="note-content">{{ note.content|linebreaks }}</div>
              <div class="note-date">Added: {{ note.created }}</div>
            </li>
            {% endfor %}
          </ul>
          {% else %}
          <div class="empty-state">No notes available for this section</div>
          {% endif %}
        </div>

      </div>
    </div>
    {% empty %}
    <div class="empty-state" style="margin: 40px 0; padding: 40px;">
      <h3>No Sections Available</h3>
      <p>This property doesn't have any documented sections yet.</p>
    </div>
    {% endfor %}

    <!-- Footer -->
    <div class="footer">
      <div class="logo-small">SellerPrep</div>
      <div>Professional Property Documentation | Generated {{ "now"|date:"F j, Y \a\\t g:i A" }}</div>
      <div>For questions about this report, contact support@sellerprep.app</div>
    </div>
  </body>
</html>